<div #toolbar class="toolbar buttons">
  <ng-container *ngFor="let button of buttons">
    <ng-container
      [ngTemplateOutlet]="buttonTemplate"
      [ngTemplateOutletContext]="{ $implicit: button }"
    ></ng-container>
  </ng-container>
</div>

<ng-template #buttonTemplate ngFor let-item>
  <button
    #button
    *ngIf="asButton(item) as b"
    [title]="b.title"
    [disabled]="isDisabled(b) | async"
    (mouseup)="b.onClick?.($event);"
  >
    {{ render(b.content, button) }}
  </button>
  <select *ngIf="asSelector(item) as s" (change)="onSelectChange(s, $event)">
    <option *ngFor="let option of s.options | keyvalue" [value]="option.key">
      {{ s.title }}: {{ option.key }}
    </option>
  </select>
  <span class="buttonGroup" *ngIf="asGroup(item) as group">
    <ng-container *ngFor="let control of group.content">
      <ng-container
        [ngTemplateOutlet]="buttonTemplate"
        [ngTemplateOutletContext]="{ $implicit: control }"
      ></ng-container>
    </ng-container>
  </span>
</ng-template>
